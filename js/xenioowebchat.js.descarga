var xenioowebchat=function(){var STREAK_START=1,STREAK_END=2,STREAK_NONE=0,config=null,rootcontainer=null,chatcontainer=null,chatarea=null,chattext=null,chatinputarea=null,options=null,buttoncounter=0,cookiename="",itemid=1,lastitemid="",counter=null,button=null,unread=0,sendbutton=null,powered=null,root="https://static.xenioo.com",api="https://app.xenioo.com",content="webchat",buttoncont=null,created=!1,audio=null,logging=!1,timewritten=!1,widget=null,reading_chat=!1,reading_scheduled=!1,read_interval=1e4,max_read_interval=1e4,chatmenuisopened=!1,userclicked=!1,calloutbubble=null,calloutbubblehint=null,isTouchDevice=!1,isMobileDevice=!1,attachmentbutton=null,clipsvg="",scrollDownChatIsAnimating=!1,pwfield=null,formopened=!1,MODE_BLOCK_PANEL=0,MODE_RIGHT_BAR=1,fileattachinput=null,buttonscontainer=null,HISTORYPOS_TOP=0,HISTORYPOS_BOTTOM=1,variables=null,lastoptext="",maxposindex=0,shared=!1,URI_RE,SCHEME_RE,quotes,default_options;function xeniooRestart(e,t){var o=document.getElementById("xenioo-container");o&&o.remove();var n=document.getElementById("xenioo-chat-widget");return n&&n.remove(),created=!1,xenioo(e,t)}function xenioo(e,t){if(!created){if(created=!0,getScriptRoot(),isTouchDevice=window.navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints>0||"ontouchstart"in document.documentElement||window.DocumentTouch&&document instanceof DocumentTouch,isMobileDevice=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobileDevice=!0),t&&t.root&&(root=t.root),t&&t.chid&&(shared=!0),-1!=e.indexOf("PREVIEW"))return init(e,t),options.preview=!0,this;enableCrossMessages(),e=getId(e);var o=new XMLHttpRequest,n=this;return o.onreadystatechange=function(){if(o.readyState==XMLHttpRequest.DONE){if(!o.response||"null"==o.response)return console.log("%cThis Xenioo chatbot is not correctly configured. The chatbot is not published or the current domain is not whitelisted. Please review your settings or contact Xenioo support.","font-size:18px;color:red;background:yellow"),t&&t.loadError&&t.loadError(),this;n.config=JSON.parse(o.response),t&&t.loadConfigCompleted&&t.loadConfigCompleted(n.config);var e=JSON.parse(o.response);e.avatarontop=!0,e.createbutton=!0,e.createarea=!0,e.enablesounds=!0,e.forceXeniooBrand=!1,e.nocounter=!1,e.buttonanimation=function(){buttonAnimationInternal(chatcontainer,button)},e.replyFn=null,e.onChatClose=function(){},e.onChatShow=function(){},e.onChatHide=function(){},e.onDataConnection=function(){},e.onItemRender=function(){},e.onElementRender=function(){},e.onButtonClick=function(){},e.onInit=function(){},e.onReady=function(){},e.onUserSays=function(){},e.onWidgetClick=function(){},e.onChatInteractionStarted=function(){},e.onChatInteractionCompleted=function(){},e.onFloatingAreaRender=function(){},e.onFloatingAreaOpened=function(){},e.onFloatingAreaClosed=function(){},e.historymode=0,e.viewmode=0,t&&mergeOptions(e,t),e.displaymode||(e.displaymode=MODE_BLOCK_PANEL),e.historystartpos||(e.historystartpos=HISTORYPOS_TOP),e.readinterval&&(max_read_interval=read_interval=e.readinterval),init(e.Id,{id:e.Id,viewmode:e.viewmode,userid:e.userid,chid:e.chid,prid:e.prid,displaymode:e.displaymode,historystartpos:e.historystartpos,name:e.Name,createbutton:e.createbutton,createarea:e.createarea,preview:e.Preview,style:e.Style,additionalstyle:e.AdditionalStyle,appeardelay:e.AppearDelay,behaviour:e.behaviour,avatarinline:e.avatarinline,avatarinlinepos:e.avatarinlinepos,forceXeniooBrand:e.forceXeniooBrand,nocounter:e.nocounter,avatarontop:e.avatarontop,avatar:e.Avatar,frame:e.Frame,placeholder:e.TextPlaceholder,buttontext:e.SendText,level:e.Level,buttonanimation:e.buttonanimation,enablesounds:e.EnableSounds,rewindchat:e.RewindChat,startopen:e.startopen,chatwidgetanchorid:e.chatwidgetanchorid,chatareaid:e.chatareaid,chattextid:e.chattextid,sendbuttonid:e.sendbuttonid,backcolor:e.BackgroundColor,forecolor:e.ForegroundColor,floatcolor:e.FloatingButtonsColor,Buttons:e.Buttons,subtitle:e.Subtitle,replyFn:e.replyFn,contexttype:e.ContextType,autoopencontext:e.AutoOpenContext,contextitle:e.ContextTitle,contextheader:e.ContextHeaderText,autoopenchatdelay:e.ChatDelay,autoopenchatmobiledisabled:e.AutoDisplayMobileDisabled,variables:e.variables,tags:e.tags,historymode:e.historymode,waitforwidgetclick:e.WaitForWidgetClick,showbubble:e.CalloutBubble,calloutmode:e.CalloutBubbleMode,hidetimepart:e.hidetimepart,landingpage:e.landingpage,appendchattoid:e.appendchattoid,displayuseravatar:e.displayuseravatar,messagedatetemplate:e.messagedatetemplate,onChatShow:e.onChatShow,onChatHide:e.onChatHide,onChatClose:e.onChatClose,onDataConnection:e.onDataConnection,onItemRender:e.onItemRender,onElementRender:e.onElementRender,onButtonClick:e.onButtonClick,onInit:e.onInit,onReady:e.onReady,onUserSays:e.onUserSays,onWidgetClick:e.onWidgetClick,onChatInteractionStarted:e.onChatInteractionStarted,onChatInteractionCompleted:e.onChatInteractionCompleted,onFloatingAreaRender:e.onFloatingAreaRender,onFloatingAreaOpened:e.onFloatingAreaOpened,onFloatingAreaClosed:e.onFloatingAreaClosed,loadCompleted:e.loadCompleted,loadConfigCompleted:e.loadConfigCompleted,loadError:e.loadError})}},o.open("GET",api+"/webapi/endpoint/chat/"+e,!0),setHeaders(o),o.send(),this}}function xeniooAutoStart(){var e=document.getElementById("xenioowebchatscript");if(e){for(var t=e.src.replace(/^[^\?]+\??/,"").split("&"),o={},n=0;n<t.length;n++){var a=t[n].split("=");o[a[0]]=decodeURI(a[1]).replace(/\+/g," ")}var i=o.bid;i&&xenioo(i)}}function xeniooLanding(e,t,o){o.createbutton=!1,o.appendchattoid=t,o.landingpage=!0,o.hidetimepart=!0,o.avatarinline=!0,o.enablesounds=!0,xenioo(e,o)}function embedChatLanding(e){if(e.container)if(e.landingUrl){var t=document.createElement("iframe");t.setAttribute("src",e.landingUrl),t.setAttribute("frameborder","0"),t.style.width="100%",t.style.height="100%",document.getElementById(e.container).appendChild(t)}else console.error("Missing landingUrl parameter!");else console.error("Missing container parameter!")}function embedChatFullPage(e){if(e.landingUrl){var t=document.createElement("iframe");t.setAttribute("src",e.landingUrl),t.setAttribute("frameborder","0"),t.style.width="100%",t.style.height="100%";var o=document.createElement("div");o.style.position="fixed",o.style.top=0,o.style.left=0,o.style.right=0,o.style.bottom=0,o.style.zIndex=1e3,o.appendChild(t),window.document.body.appendChild(o)}else console.error("Missing landingUrl parameter!")}function getId(e){return-1!=e.indexOf("|")?e.split("|")[0]:e}function mergeOptions(e,t){e.loadCompleted=t.loadCompleted,e.loadError=t.loadError,e.loadConfigCompleted=t.loadConfigCompleted,e.variables=t.variables,e.tags=t.tags,isDefined(t.showbubble)&&(e.CalloutBubble=t.showbubble),t.displayuseravatar&&(e.displayuseravatar=t.displayuseravatar),t.messagedatetemplate&&(e.messagedatetemplate=t.messagedatetemplate),t.chatdelay&&(e.ChatDelay=t.chatdelay),t.autodisplaymobiledisabled&&(e.AutoDisplayMobileDisabled=t.autodisplaymobiledisabled),t.waitforwidgetclick&&(e.WaitForWidgetClick=t.waitforwidgetclick),t.historymode&&(e.historymode=t.historymode),t.floatingcontext&&(e.ContextType=t.floatingcontext?1:0),t.autoopencontext&&(e.AutoOpenContext=t.autoopencontext),t.startopen&&(e.startopen=t.startopen),t.chatwidgetanchorid&&(e.chatwidgetanchorid=t.chatwidgetanchorid),t.chatareaid&&(e.chatareaid=t.chatareaid),isDefined(t.appeardelay)&&(e.AppearDelay=t.appeardelay),t.chattextid&&(e.chattextid=t.chattextid),t.sendbuttonid&&(e.sendbuttonid=t.sendbuttonid),t.style&&(e.Style=t.style),t.additionalstyle&&(e.AdditionalStyle=t.additionalstyle),isDefined(t.avatarinline)&&(e.avatarinline=t.avatarinline),isDefined(t.avatarinlinepos)&&(e.avatarinlinepos=t.avatarinlinepos),t.forceXeniooBrand&&(e.forceXeniooBrand=t.forceXeniooBrand),t.nocounter&&(e.nocounter=t.nocounter),isDefined(t.rewindchat)&&(e.RewindChat=t.rewindchat),isDefined(t.avatarontop)&&(e.avatarontop=t.avatarontop),isDefined(t.enablesounds)&&(e.EnableSounds=t.enablesounds),isDefined(t.createbutton)&&(e.createbutton=t.createbutton),isDefined(t.createarea)&&(e.createarea=t.createarea),isDefined(t.Frame)&&(e.Frame=t.Frame),t.buttonanimation&&(e.buttonanimation=t.buttonanimation),t.foregroundColor&&(e.ForegroundColor=t.foregroundColor),t.backgroundColor&&(e.BackgroundColor=t.backgroundColor),t.subtitle&&(e.Subtitle=t.subtitle),t.replyFn&&(e.replyFn=t.replyFn),t.onChatShow&&(e.onChatShow=t.onChatShow),t.onChatHide&&(e.onChatHide=t.onChatHide),t.onChatClose&&(e.onChatClose=t.onChatClose),t.onDataConnection&&(e.onDataConnection=t.onDataConnection),t.onItemRender&&(e.onItemRender=t.onItemRender),t.onElementRender&&(e.onElementRender=t.onElementRender),t.onButtonClick&&(e.onButtonClick=t.onButtonClick),t.onInit&&(e.onInit=t.onInit),t.onReady&&(e.onReady=t.onReady),t.onUserSays&&(e.onUserSays=t.onUserSays),t.onWidgetClick&&(e.onWidgetClick=t.onWidgetClick),t.onChatInteractionStarted&&(e.onChatInteractionStarted=t.onChatInteractionStarted),t.onChatInteractionCompleted&&(e.onChatInteractionCompleted=t.onChatInteractionCompleted),t.onFloatingAreaRender&&(e.onFloatingAreaRender=t.onFloatingAreaRender),t.onFloatingAreaOpened&&(e.onFloatingAreaOpened=t.onFloatingAreaOpened),t.onFloatingAreaClosed&&(e.onFloatingAreaClosed=t.onFloatingAreaClosed),t.behaviour&&(e.behaviour=t.behaviour),isDefined(t.hidetimepart)&&(e.hidetimepart=t.hidetimepart),isDefined(t.landingpage)&&(e.landingpage=t.landingpage),isDefined(t.appendchattoid)&&(e.appendchattoid=t.appendchattoid),isDefined(t.displaymode)&&(e.displaymode=t.displaymode),isDefined(t.historystartpos)&&(e.historystartpos=t.historystartpos),isDefined(t.placeholder)&&(e.TextPlaceholder=t.placeholder),isDefined(t.displayuseravatar)&&(e.displayuseravatar=t.displayuseravatar),t.avatarurl&&(e.Avatar=t.avatarurl),t.sid&&(e.userid=t.sid),t.chid&&(e.chid=t.chid),t.prid&&(e.prid=t.prid),t.readinterval&&(e.readinterval=t.readinterval),t.viewmode&&(e.viewmode=t.viewmode)}function isDefined(e){return!(void 0===e)}function getScriptRoot(){var e=document.querySelector('script[data-id="xenioo"]');if(null!=e&&e){var t=e.getAttribute("data-node");if(null!=t&&t)return"localhost"==t?(api=window.location.protocol+"//"+window.location.hostname+":"+window.location.port,root=window.location.protocol+"//"+window.location.hostname+":"+window.location.port,void(content="webchatsrc")):"loopback"==t?(api=window.location.protocol+"//"+window.location.hostname+":"+window.location.port,root=window.location.protocol+"//"+window.location.hostname+":"+window.location.port,void("localhost"==window.location.hostname&&(content="webchatsrc"))):void(api="https://"+t+".xenioo.com")}}function init(e,t){(options=t).onInit&&options.onInit(),null!=options.variables&&options.variables||(options.variables=[]),null!=options.tags&&options.tags||(options.tags=[]),parseOptions(e),loadResources(function(){if(createPageWidget(),cookiename="xenioo-"+options.id,options.userid||(options.userid=readCookie(cookiename)),setLastContact(),setFirstContact(),widget&&options.chatwidgetanchorid){var e=window.document.getElementById(options.chatwidgetanchorid);widget.style.position="absolute",e.appendChild(widget)}null==chatarea&&options.chatareaid&&((chatarea=window.document.getElementById(options.chatareaid)).setAttribute("class","xenioo-conversation-custom"),options.avatarinline&&chatarea.classList.add("x-avatarinline"),chatarea.innerHTML=""),null==chattext&&options.chattextid&&(chattext=window.document.getElementById(options.chattextid)),null==sendbutton&&options.sendbuttonid&&(sendbutton=window.document.getElementById(options.sendbuttonid)),null!=options.replyFn&&(doReply=options.replyFn,writePart=function(){},writeTime=function(){},write=function(){},endWait=function(){},scollDownChat=function(){}),options.onReady&&options.onReady(),setTimeout(function(){getWelcome()},1e3*options.appeardelay)})}function loadResources(e){isNullOrEmpty(options.additionalstyle)?-1!=options.style.indexOf("://")?loadCSS(options.style,function(){loadCSS("//fonts.googleapis.com/css?family=Roboto:300,400,500,300italic",e)}):loadCSS(root+"/"+content+"/"+options.style+".css",function(){loadCSS("//fonts.googleapis.com/css?family=Roboto:300,400,500,300italic",e)}):loadCSS(root+"/"+content+"/"+options.style+".css",function(){loadCSS(options.additionalstyle,function(){loadCSS("//fonts.googleapis.com/css?family=Roboto:300,400,500,300italic",e)})})}function createPageWidget(){if(!options.createbutton)return createChatArea(),void createAttachmentButton(document.body);createChatWidget(),createChatArea(),window.document.body.appendChild(button)}function createChatWidget(){(widget=document.createElement("div")).setAttribute("id","xenioo-chat-widget"),widget.setAttribute("class","xenioo-chat-widget"),widget.style.opacity=0;var e=document.createElement("div");if(e.setAttribute("id","xenioo-chat-widget-button"),e.setAttribute("class","xenioo-chat-widget-button"),e.style.backgroundColor=options.backcolor,e.style.color=options.forecolor,e.style.backgroundImage="url('"+getAvatarImage(),e.style.backgroundSize="cover",widget.appendChild(e),!options.nocounter){var t=document.createElement("div");t.setAttribute("id","xenioo-chat-widget-counter"),t.setAttribute("class","xenioo-chat-widget-counter"),widget.appendChild(t),counter=t}button=widget,widget.onclick=function(){userclicked=!0,null!=calloutbubble&&hideCallout(),options.onWidgetClick&&options.onWidgetClick(),options.waitforwidgetclick?(toggleChat(),getWelcome()):toggleChat()},setCounter(0)}function createChatArea(){if(options.createarea){(rootcontainer=document.createElement("div")).setAttribute("id","xenioo-container"),rootcontainer.classList.add("xenioo-container"),rootcontainer.classList.add("xenioo-chat-reset"),options.landingpage&&rootcontainer.classList.add("xenioo-landing"),options.landingpage&&rootcontainer.classList.add("xenioo-composer-detached"),(chatcontainer=document.createElement("div")).setAttribute("id","xenioo-conversation"),chatcontainer.setAttribute("class","xenioo-conversation"),chatcontainer.classList.add("xenioo-conversation-right"),options.displaymode==MODE_RIGHT_BAR&&chatcontainer.classList.add("xenioo-conversation-panel"),options.frame&&"xenioo-frame.jpg"!=options.frame&&(chatcontainer.style.backgroundImage="url('"+getImage(options.frame));var e=createChatConversationHeader(),t=createChatConversationBody(),o=chatinputarea=createChatConversationComposer();if(options.landingpage||chatcontainer.appendChild(e),chatcontainer.appendChild(t),options.landingpage?(o.style.opacity=0,t.appendChild(o)):chatcontainer.appendChild(o),rootcontainer.appendChild(chatcontainer),options.landingpage&&options.appendchattoid)window.document.getElementById(options.appendchattoid).appendChild(rootcontainer);else window.document.body.appendChild(rootcontainer)}}function createChatConversationHeader(){var e=document.createElement("div");e.setAttribute("id","xenioo-conversation-header"),e.setAttribute("class","xenioo-conversation-header"),options.avatarinline&&e.classList.add("x-avatarinline"),e.style.backgroundColor=options.backcolor,e.style.color=options.forecolor;var t=document.createElement("div");if(t.setAttribute("id","xenioo-conversation-header-title-container"),t.setAttribute("class","xenioo-conversation-header-title-container"),e.appendChild(t),!options.avatarinline&&options.avatarontop){var o=document.createElement("div");o.setAttribute("id","xenioo-conversation-header-avatar-container"),o.setAttribute("class","xenioo-conversation-header-avatar-container"),e.appendChild(o)}var n=document.createElement("div");n.setAttribute("id","xenioo-conversation-close-button"),n.setAttribute("class","xenioo-conversation-close-button"),n.onclick=function(){options.onChatClose&&options.onChatClose(),toggleChat()},e.appendChild(n);var a=document.createElement("div");a.setAttribute("id","xenioo-conversation-header-title"),a.setAttribute("class","xenioo-conversation-header-title"),a.style.color=options.forecolor,a.innerHTML=options.name;var i=document.createElement("div");if(i.setAttribute("id","xenioo-conversation-header-subtitle"),i.setAttribute("class","xenioo-conversation-header-subtitle"),i.style.color=options.forecolor,i.innerHTML=options.subtitle,t.appendChild(a),t.appendChild(i),!options.avatarinline&&options.avatarontop){var r=document.createElement("img");r.setAttribute("id","xenioo-conversation-header-avatar-image"),r.setAttribute("class","xenioo-conversation-header-avatar-image"),r.src=getAvatarImage(),o.appendChild(r)}var s="<svg class='xenioo-conversation-close-button-icon' viewBox='0 0 32 32' version='1.1'><g fill='"+options.forecolor+"'><path d='M 8.71875 7.28125 L 7.28125 8.71875 L 14.5625 16 L 7.28125 23.28125 L 8.71875 24.71875 L 16 17.4375 L 23.28125 24.71875 L 24.71875 23.28125 L 17.4375 16 L 24.71875 8.71875 L 23.28125 7.28125 L 16 14.5625 Z'></path></g></svg>",l=document.createElement("span");return l.innerHTML=s,n.appendChild(l),e}function createChatConversationComposer(){var e=document.createElement("div");if(e.setAttribute("id","xenioo-conversation-composer"),e.setAttribute("class","xenioo-conversation-composer"),e.style.backgroundColor=options.backcolor,e.style.color=options.forecolor,"1"==options.level||options.forceXeniooBrand){var t=document.createElement("div");t.setAttribute("id","xenioo-conversation-poweredby"),t.setAttribute("class","xenioo-conversation-poweredby"),e.appendChild(t)}var o=document.createElement("div");o.setAttribute("class","xenioo-conversation-composer-container"),e.appendChild(o),createContextMenu(o),options.preview||createFloatingExtraContentContainer(),(buttonscontainer=document.createElement("div")).setAttribute("id","xenioo-conversation-composer-buttonscontainer"),buttonscontainer.setAttribute("class","xenioo-conversation-composer-buttonscontainer"),o.appendChild(buttonscontainer);var n=document.createElement("div");n.setAttribute("id","xenioo-conversation-composer-textarea"),n.setAttribute("class","xenioo-conversation-composer-textarea"),o.appendChild(n);var a=document.createElement("div");if(a.setAttribute("id","xenioo-conversation-composer-sendbutton"),a.setAttribute("class","xenioo-conversation-composer-sendbutton"),o.appendChild(a),"1"==options.level||options.forceXeniooBrand){var i=document.createElement("div");i.setAttribute("id","xenioo-conversation-poweredby-text"),i.setAttribute("class","xenioo-conversation-poweredby-text"),i.innerHTML="We're<i><svg width='7' height='13' viewBox='0 0 7 13'><g fill='none' fill-rule='evenodd'><path d='M4.127.496C4.51-.12 5.37.356 5.16 1.07L3.89 5.14H6.22c.483 0 .757.616.464 1.044l-4.338 6.34c-.407.595-1.244.082-1.01-.618L2.72 7.656H.778c-.47 0-.748-.59-.48-1.02L4.13.495z' fill='#F6A623'></path><path fill='#FEF79E' d='M4.606.867L.778 7.007h2.807l-1.7 5.126 4.337-6.34H3.16'></path></g></svg></i>by&nbsp;<a href='https://www.xenioo.com' target='_blank'>Xenioo</a>",t.appendChild(i)}var r=document.createElement("div");r.setAttribute("id","xenioo-conversation-textarea"),r.setAttribute("class","xenioo-conversation-textarea");var s=document.createElement("textarea");s.placeholder=options.placeholder,s.setAttribute("id","xenioo-user-chat-textarea-control"),s.onkeydown=function(e){if(13==e.keyCode)return say(e.currentTarget.value.trim()),e.currentTarget.value="",e.preventDefault(),!1},n.appendChild(r),r.appendChild(s);var l=document.createElement("button");return l.innerHTML="<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'><path fill='"+options.forecolor+"' d='M1.101 21.757L23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z'></path></svg>",l.onclick=function(){var e=s.value;return e&&e.trim().length>0&&(say(e.trim()),s.value=""),!1},a.appendChild(l),createAttachmentButton(buttonscontainer),chattext=s,e}function createAttachmentButton(e){createAttachmentInput(e),this.attachmentbutton=document.getElementById("xenioo-attachment"),this.attachmentbutton?this.attachmentbutton.style.display="none":(this.attachmentbutton=document.createElement("button"),this.attachmentbutton.id="xenioo-attachment",this.attachmentbutton.style.display="none",this.attachmentbutton.innerHTML="<svg width='18' height='17' viewBox='0 0 18 17' xmlns='http://www.w3.org/2000/svg'><path fill='"+options.forecolor+"' d='M8.455 16.5c-.19 0-.378-.076-.522-.226-.29-.303-.29-.792 0-1.093l7.66-8.013c.57-.597.885-1.392.885-2.236 0-.844-.315-1.638-.886-2.235-1.18-1.233-3.097-1.232-4.275 0L2.433 11.99c-.5.525-.742 1.03-.715 1.502.026.46.303.815.467.985.275.29.573.41.908.364.42-.054.903-.356 1.398-.874l6.973-7.295c.288-.3.755-.3 1.043 0 .29.303.29.793 0 1.093l-6.97 7.296c-.74.773-1.5 1.215-2.26 1.314-.797.104-1.535-.175-2.135-.804-.537-.562-.856-1.267-.896-1.985-.054-.933.332-1.836 1.144-2.686l8.885-9.297c1.754-1.836 4.61-1.836 6.363 0 .85.888 1.318 2.07 1.318 3.328s-.468 2.44-1.318 3.33l-7.66 8.014c-.143.15-.332.226-.52.226z' fill-rule='evenodd'></path></svg>",this.attachmentbutton.onclick=function(){attachFile()},e.appendChild(this.attachmentbutton))}function createAttachmentInput(e){(fileattachinput=document.createElement("input")).type="file",fileattachinput.style.display="none",fileattachinput.onchange=function(e){sendAttachment(e.target.files[0])},e.appendChild(fileattachinput)}function attachFile(){fileattachinput.click()}function createContextMenu(e){if(options.Buttons&&options.Buttons.length>0){var t=document.createElement("div");t.setAttribute("id","xenioo-conversation-composer-menubutton"),t.setAttribute("class","xenioo-conversation-composer-menubutton"),t.innerHTML='<svg width="24px" height="24px" viewBox="0 0 24 24"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill="'+options.forecolor+'"><rect x="2" y="3" width="20" height="1"></rect><rect x="2" y="11" width="20" height="1"></rect><rect x="2" y="19" width="20" height="1"></rect></g></g></svg>',e.appendChild(t),t.onclick=function(){toggleChatMenu()};1==options.contexttype?createFloatingChatConversationComposerMenuView():e.appendChild(createChatConversationComposerMenuView())}}function createFloatingExtraContentContainer(){if(rootcontainer){var e=document.createElement("div");e.setAttribute("id","xenioo-floating-extra-content"),e.classList.add("xenioo-floating-context"),e.classList.add("xenioo-floating-extra-content-right"),options.displaymode==MODE_RIGHT_BAR&&e.classList.add("xenioo-floating-extra-content-panel");var t=document.createElement("div");t.setAttribute("id","xenioo-floating-context-header"),t.setAttribute("class","xenioo-floating-context-header"),t.style.backgroundColor=options.backcolor,t.style.color=options.forecolor;var o=document.createElement("div");o.setAttribute("id","xenioo-floating-extra-content-header-title-container"),o.setAttribute("class","xenioo-floating-context-header-title-container"),t.appendChild(o);var n=document.createElement("div");n.setAttribute("id","xenioo-floating-context-close-button"),n.setAttribute("class","xenioo-floating-context-close-button"),n.onclick=function(){toggleFloatContent()},t.appendChild(n);var a=document.createElement("div");a.setAttribute("id","xenioo-floating-extra-content-header-title"),a.setAttribute("class","xenioo-floating-context-header-title"),a.style.color=options.forecolor,a.innerHTML=options.contextitle,o.appendChild(a);var i="<svg class='xenioo-floating-context-close-button-icon' viewBox='0 0 32 32' version='1.1'><g fill='"+options.forecolor+"'><path d='M 8.71875 7.28125 L 7.28125 8.71875 L 14.5625 16 L 7.28125 23.28125 L 8.71875 24.71875 L 16 17.4375 L 23.28125 24.71875 L 24.71875 23.28125 L 17.4375 16 L 24.71875 8.71875 L 23.28125 7.28125 L 16 14.5625 Z'></path></g></svg>",r=document.createElement("span");r.innerHTML=i,n.appendChild(r),t.appendChild(n),e.appendChild(t);var s=document.createElement("div");s.setAttribute("id","xenioo-floating-extra-content-body"),s.setAttribute("class","xenioo-floating-extra-content-body"),e.appendChild(s),rootcontainer.appendChild(e)}}function createFloatingChatConversationComposerMenuView(){if(rootcontainer){var e=document.createElement("div");e.setAttribute("id","xenioo-floating-context"),e.classList.add("xenioo-floating-context"),e.classList.add("xenioo-floating-context-right");var t=document.createElement("div");t.setAttribute("id","xenioo-floating-context-header"),t.setAttribute("class","xenioo-floating-context-header"),t.style.backgroundColor=options.backcolor,t.style.color=options.forecolor;var o=document.createElement("div");o.setAttribute("id","xenioo-floating-context-header-title-container"),o.setAttribute("class","xenioo-floating-context-header-title-container"),t.appendChild(o);var n=document.createElement("div");n.setAttribute("id","xenioo-floating-context-close-button"),n.setAttribute("class","xenioo-floating-context-close-button"),n.onclick=function(){toggleChatMenu()},t.appendChild(n);var a=document.createElement("div");a.setAttribute("id","xenioo-floating-context-header-title"),a.setAttribute("class","xenioo-floating-context-header-title"),a.style.color=options.forecolor,a.innerHTML=options.contextitle,o.appendChild(a);var i="<svg class='xenioo-floating-context-close-button-icon' viewBox='0 0 32 32' version='1.1'><g fill='"+options.forecolor+"'><path d='M 8.71875 7.28125 L 7.28125 8.71875 L 14.5625 16 L 7.28125 23.28125 L 8.71875 24.71875 L 16 17.4375 L 23.28125 24.71875 L 24.71875 23.28125 L 17.4375 16 L 24.71875 8.71875 L 23.28125 7.28125 L 16 14.5625 Z'></path></g></svg>",r=document.createElement("span");r.innerHTML=i,n.appendChild(r),t.appendChild(n),e.appendChild(t);var s=document.createElement("div");s.setAttribute("id","xenioo-floating-context-body"),s.setAttribute("class","xenioo-floating-context-body"),e.appendChild(s);var l=document.createElement("div");l.setAttribute("id","xenioo-floating-context-body-header"),l.setAttribute("class","xenioo-floating-context-body-header"),l.innerHTML=options.contextheader,s.appendChild(l);for(var c=0;c<options.Buttons.length;c++){var d=document.createElement("div");d.setAttribute("id","xenioo-floating-context-body-context-button"),d.setAttribute("class","xenioo-floating-context-body-context-button"),d.innerHTML=renderButton(options.Buttons[c]),s.appendChild(d)}rootcontainer.appendChild(e)}}function createChatConversationComposerMenuView(){var e=document.createElement("div");e.setAttribute("id","xenioo-conversation-composer-menuview"),e.setAttribute("class","xenioo-conversation-composer-menuview");var t=document.createElement("div");t.setAttribute("id","xenioo-conversation-composer-menuview-header"),t.setAttribute("class","xenioo-conversation-composer-menuview-header"),t.style.backgroundColor=options.backcolor,t.style.color=options.forecolor;var o=document.createElement("span");o.innerHTML="<svg class='xenioo-conversation-composer-menuview-close-button-icon' viewBox='0 0 32 32' version='1.1'><g><path d='M 8.71875 7.28125 L 7.28125 8.71875 L 14.5625 16 L 7.28125 23.28125 L 8.71875 24.71875 L 16 17.4375 L 23.28125 24.71875 L 24.71875 23.28125 L 17.4375 16 L 24.71875 8.71875 L 23.28125 7.28125 L 16 14.5625 Z'></path></g></svg>",t.onclick=function(){toggleChatMenu()},t.appendChild(o),e.appendChild(t);for(var n=0;n<options.Buttons.length;n++){var a=document.createElement("div");a.innerHTML=renderButton(options.Buttons[n]),e.appendChild(a)}return e}function createChatConversationBody(){var e=document.createElement("div");return e.setAttribute("id","xenioo-conversation-body"),e.classList.add("xenioo-conversation-body"),options.avatarinline&&e.classList.add("x-avatarinline"),("1"==options.level||options.forceXeniooBrand)&&e.classList.add("x-poweredby"),chatarea=e,e}function toggleChat(){options.buttonanimation&&options.buttonanimation(chatcontainer,widget)}function closeFloatContent(){var e=document.getElementById("xenioo-floating-extra-content");null!=e&&e.classList.contains("opened")&&toggleFloatContent()}function openFloatContent(){var e=document.getElementById("xenioo-floating-extra-content");null!=e&&(e.classList.contains("opened")||toggleFloatContent())}function floatContentIsOpenend(){var e=document.getElementById("xenioo-floating-extra-content");return!!e&&e.classList.contains("opened")}function toggleFloatContent(){var e=document.getElementById("xenioo-floating-extra-content");e&&(e.classList.contains("opened")?(e.classList.remove("opened"),e.setAttribute("style",""),options.displaymode==MODE_RIGHT_BAR&&chatcontainer.classList.add("xenioo-conversation-active"),options.onFloatingAreaClosed&&options.onFloatingAreaClosed()):(e.classList.add("opened"),options.displaymode==MODE_RIGHT_BAR&&chatcontainer.classList.remove("xenioo-conversation-active"),options.onFloatingAreaOpened&&options.onFloatingAreaOpened()))}function closeMenuIfOpened(){var e="xenioo-conversation-composer-menuview";1==options.contexttype&&(e="xenioo-floating-context");var t=document.getElementById(e);t&&t.classList.contains("opened")&&toggleChatMenu()}function toggleChatMenu(){var e="xenioo-conversation-composer-menuview";1==options.contexttype&&(e="xenioo-floating-context");var t=document.getElementById(e);t&&(t.classList.contains("opened")?(chatmenuisopened=!1,t.classList.remove("opened")):(chatmenuisopened=!0,t.classList.add("opened")))}function closeChatMenuIfOpened(){if(chatmenuisopened){var e="xenioo-conversation-composer-menuview";1==options.contexttype&&(e="xenioo-floating-context");var t=document.getElementById(e);t&&(chatmenuisopened=!1,t.classList.remove("opened"))}}function buttonAnimationInternal(e,t){e&&(e.classList.contains("xenioo-conversation-active")?(e.classList.remove("xenioo-conversation-active"),rootcontainer.classList.remove("xenioo-conversation-active"),closeMenuIfOpened(),options.displaymode==MODE_RIGHT_BAR&&moveinChatWidget(),options.onChatHide&&options.onChatHide()):(e.classList.add("xenioo-conversation-active"),rootcontainer.classList.add("xenioo-conversation-active"),setCounter(0),options.autoopencontext&&toggleChatMenu(),options.displaymode==MODE_RIGHT_BAR&&moveoutChatWidget(),options.onChatShow&&options.onChatShow()))}function closeChat(){isChatOpened()&&toggleChat()}function openChat(){isChatOpened()||toggleChat()}function isChatOpened(){return!chatcontainer||chatcontainer.classList.contains("xenioo-conversation-active")}function hideChatWidget(){widget&&(widget.style.display="none")}function showChatWidget(){widget&&(widget.style.display="block")}function moveoutChatWidget(){widget&&(widget.style.right="-100px",widget.style.opacity="0")}function moveinChatWidget(){widget&&(widget.style.right="20px",widget.style.opacity="1")}function getAvatarImage(){return-1!=options.avatar.indexOf("://")?options.avatar:api+"/webchatsrc/"+options.avatar}function getImage(e){return-1!=e.indexOf("://")?e:api+"/webchatsrc/"+e}function setCounter(e){null!=button&&chatcontainer&&(0==e||chatcontainer.classList.contains("xenioo-conversation-active")?(counter&&(counter.style.opacity=0),unread=0):(0==button.style.opacity&&(button.style.opacity=1),counter&&null!=e?(counter.innerHTML=e,counter.style.opacity=1):counter.style.opacity=0))}function parseOptions(e){if(e&&!(e.indexOf("|")<0)){var t=e.split("|");return e=t[0],options.behaviour=t[1],options.preview="True"==t[2],options.id=e,e}}function say(e,t,o){isNullOrEmpty(e)&&isNullOrEmpty(e=chattext.value)||chattext&&chattext.disabled||doCommand(e,t,o)}function doCommand(e,t,o){if(options.viewmode<2)writeUser(e);else{lastoptext=e;var n={Type:0,Text:e,Creation:new Date};writePart(n,0),writeTime(n,!1),scollDownChat(chatarea,1e3)}send(e,t,o)}function handOver(){confirm("Hand over the conversation to Xenioo?\r\nThis will transform this share into a standard view share.")&&send(null,"HAND_OVER",null)}function goTo(e,t,o){send(null,"GOTO:1|"+e+"|"+t,o)}function writeUser(e){0==e.indexOf("<<__password__>>")&&(e="******");var t="",o="",n="";if(options.displayuseravatar){var a=getVariable("profile_pic");null!=a&&a||(a="https://static.xenioo.com/webchat/user_avatar.png"),t="<div class='xenioo-avatar-message-bubble'>",o="<div class='xenioo-user-avatar-image-container' style=\"border: solid 2px "+options.backcolor+";background:Url('"+a+"');background-size:cover;\"></div>",n="u-bubble-with-avatar"}write(t+"<div class='u-message-bubble fix-sizing'><div class='u-bubble-hint fix-sizing'></div><div class='u-bubble-text fix-sizing "+n+"' style='color:"+options.forecolor+";background-color:"+options.backcolor+";'>"+e+"</div></div>"+o),0==options.viewmode&&write("<div id='x-tempwait' class='x-message-bubble fix-sizing'><img class='x-wait-img' width='48' src='"+root+"/"+content+"/loader.gif'></div>")}function setUserIdInfo(e){void 0!==e.UserId&&null==options.userid&&(options.userid=e.UserId,writeCookie(cookiename,options.userid,3650))}function doReply(e,t){if(e)if(setUserIdInfo(e),this.variables=e.Variables,e.close)window.location.reload();else{e.I>maxposindex&&(maxposindex=e.I,console.log("POS:"+maxposindex));var o=e.Parts;if(o){if(void 0===t&&(t=0),postReplyMsg(e),options.landingpage&&0==t&&chatinputarea&&(chatinputarea.style.opacity=0),0==t&&(sendbutton&&(sendbutton.disabled=0==e.ControlType),chattext&&(chattext.disabled=0==e.ControlType),options.onChatInteractionStarted&&options.onChatInteractionStarted()),options.historystartpos==HISTORYPOS_BOTTOM&&!options.chatstarted){var n=document.getElementById("xenioo-conversation-body");n&&null!=n&&(options.chatstarted=!0,write("<div style='flex: 1 1 auto;'></div>"),n.style.display="flex",n.style.flexDirection="column")}if(0==o.length&&options.preview)return writeWarning("<b>Ouch!??</b><br>Looks like this bot did not send any meaningful message during preview mode.<br>???Please check that all the interactions items are correctly configured."),writeWarning("<b>Do not despair!</b><br>If you have troubles building your bot, please try checking out our tutorials!??<br>https://www.xenioo.com/tutorials/"),void writeWarning("<b>...Or not?</b><br>If the last block was just ment to be an execution or data processing, this is fine :)");for(var a=t;a<o.length;a++){var i=o[a];if(-1!=i.TypeDelay||-1!=options.historymode){options.onItemRender&&options.onItemRender(i);if(unread++,i.TypeDelay>0&&!logging){(25==i.Type&&i.Data.ShowTypingIndicator||25!=i.Type)&&writeWait(),setTimeout(function(){writePart(i,a,o),doReply(e,a+1),setCounter(unread),a==o.length-1&&EndTransmissions(e,i)},i.TypeDelay);break}writePart(i,a,o),setCounter(unread),a==o.length-1&&EndTransmissions(e,i)}}scollDownChat(chatarea,1e3)}}}function writeWait(){0==options.viewmode&&write("<div id='x-tempwait' class='x-message-bubble fix-sizing'><img class='x-wait-img' width='48' src='"+root+"/"+content+"/loader.gif'></div>")}function EndTransmissions(e,t){null!=e.Parts&&0!=e.Parts.length&&(null!=buttoncont&&(buttoncont=null),playSound(),!options.preview&&t&&t.Parts.length>0&&t.Parts[0].Data&&t.Parts[0].Data.RedirectToFloating||floatContentIsOpenend()||19==t.Type||writeTime(e),1==e.ControlType?(sendbutton&&(sendbutton.disabled=!1),chattext.disabled=!1):(sendbutton&&(sendbutton.disabled=!e.EnableUserChat),chattext&&(chattext.disabled=!e.EnableUserChat)),options.landingpage&&chatinputarea&&(chatinputarea.style.opacity=1),chattext&&!isMobileDevice&&chattext.focus(),logging=!1,timewritten=!1,options.startopen&&(options.startopen=!1,toggleChat()),options.onChatInteractionCompleted&&options.onChatInteractionCompleted())}function playSound(){if(options.enablesounds){null==audio&&((audio=new Audio(root+"/"+content+"/bling.mp3")).volume=.5);var e=audio.play();void 0!==e&&e.then(e=>{}).catch(e=>{})}}function writeTime(e,t){if(timewritten=!0,!options.hidetimepart){var o=new Date(e.Creation),n=document.createElement("div");n.setAttribute("id","x-message-time"),t?n.setAttribute("class","u-message-time"):n.setAttribute("class","x-message-time"),n.innerHTML=getDateFromTemplate(o),chatarea&&(options.landingpage?chatarea.insertBefore(n,chatinputarea):chatarea.appendChild(n))}}function getDateFromTemplate(e){options.messagedatetemplate||(options.messagedatetemplate="Sent hh:mm AMPM");var t=e.getHours(),o=e.getMinutes(),n=e.getSeconds(),a="am",i=t;i>12&&(i-=12,a="pm"),o=o<10?"0"+o:o,n=n<10?"0"+n:n;var r=options.messagedatetemplate;return r=(r=(r=(r=(r=r.replace("HH",t)).replace("hh",i)).replace("mm",o)).replace("ss",n)).replace("AMPM",a)}function getInline(){return options.avatarinline?"":"-inline"}function getAvatarInline(e){return options.avatarinline?0!=options.avatarinlinepos?(removeAll("xenioo-inline-avatar-image"),"<div id='xenioo-inline-avatar-image' class='x-avatar-img' style='background-image:url(\""+getAvatarImage()+"\"); background-size: contain;top:unset!important;bottom:0px;'></div>"):0==e||e>0&&timewritten?"<div class='x-avatar-img' style='background-image:url(\""+getAvatarImage()+"\"); background-size: contain;'></div>":"":""}function getMessageBubbleClass(){return"x-bubble-text"}function endWait(){removeAll("x-tempwait"),removeAll("x-form-wait-img")}function removeAll(e){for(var t=document.getElementById(e);null!=t;)t.parentElement.removeChild(t),t=document.getElementById(e)}function writePart(part,index,parts){endWait();var tx=fix(part.Text);switch(1!=part.Type&&null!=buttoncont&&(buttoncont=null),"pw"==part.SubType?createPasswordField():removePasswordField(),"attachment"==part.SubType?null!=this.attachmentbutton&&(this.attachmentbutton.style.display=""):null!=this.attachmentbutton&&(this.attachmentbutton.style.display="none"),part.Type){case 0:case 6:if(isNullOrEmpty(tx)){unread--;break}var displaytext=linkify(tx),customstyle=part.Data&&part.Data.CssClass?replaceQuote(part.Data.CssClass):"";write("<div class='x-message-bubble "+customstyle+"'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-bubble-hint'></div><div class='"+getMessageBubbleClass()+"'>"+displaytext+"</div></div></div>",null,part),options.calloutmode>0&&(2==options.calloutmode&&0==index||1==options.calloutmode&&index>0)&&showCallout(displaytext);break;case 1:unread--,displayButton(tx,index,part),buttoncounter++;break;case 3:var content="<img class='x-image-element' src='"+tx+"'>";part.Command&&(content="<a href='"+part.Command+"' target='_blank'>"+content+"</a>"),write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-image'>"+content+"</div></div></div>",null,part);break;case 9:write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-video'><video class='x-video-control' controls><source src='"+part.Text+"'></video></div></div></div>",null,part);break;case 10:write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-audio'><audio class='x-audio-control' controls><source src='"+part.Text+"'></audio></div></div></div>",null,part);break;case 11:write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-bubble-hint'></div><div class='"+getMessageBubbleClass()+"'><a href='"+part.Text+"' download>Download File</a></div></div></div>",null,part);break;case 13:write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'>"+renderCard(part,!1)+"</div></div></div>",null,part);break;case 5:part.Parts[0].Data.RedirectToFloating&&!options.preview?showFloatCard(part.Parts[0]):(write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'>"+renderCarousel(part)+"</div></div></div>",null,part),isTouchDevice&&detectswipe("carousel_"+(itemid-1),itemid-1,function(e,t,o){"r"==o?xenioowebchat.ScrollCarousel(-4,1,-1):(o="l")&&xenioowebchat.ScrollCarousel(4,1,1)}));break;case 12:write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'>"+renderList(part)+"</div></div></div>",null,part);break;case 17:part.Data&&part.Data.RedirectToFloating&&!options.preview?showFloatingUrl(part):part.Data&&part.Data.Description?write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-list-container fix-sizing' id='"+getChatItemId()+"'>"+renderListItem(part,!1)+"</div></div></div></div>",null,part):part.Data.OpenInSameWindow&&!options.preview?write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-bubble-hint'></div><div class='"+getMessageBubbleClass()+"'><a target='_self' href='"+part.Command+"'>"+part.Text+"</a></div></div></div>",null,part):write("<div class='x-message-bubble'>"+getAvatarInline(index)+"<div class='x-message-bubble-content'><div class='x-bubble-hint'></div><div class='"+getMessageBubbleClass()+"'><a target='_blank' href='"+part.Command+"'>"+part.Text+"</a></div></div></div>",null,part);break;case 19:parts&&index>0&&19!=parts[index-1].Type&&writeTime(parts[index-1],!1),writeUser(part.Text),writeTime(part,!0);break;case 25:break;case 27:try{eval(part.Text)}catch(e){console.log("Xenioo -- JSEval:"+e.message)}break;case 30:displayButton(part.Text,index,{Text:part.Text,SubType:"url",Command:part.Data.Url,Data:part.Data});break;default:unread--,console.log("Unknow tag type:"+part.Type)}}function createPasswordField(){if(null==pwfield){(pwfield=document.createElement("input")).type="text";var e=window.getComputedStyle(pwfield);e.webkitTextSecurity||""==e.webkitTextSecurity?pwfield.style.webkitTextSecurity="disc":pwfield.type="password",pwfield.className="message-text",pwfield.style.webkitTextSecurity="disc",pwfield.onkeydown=function(e){if(13==e.keyCode)return say("<<__password__>>"+e.currentTarget.value.trim()),e.currentTarget.value="",e.preventDefault(),!1};var t=document.getElementById("xenioo-conversation-textarea");t&&null!=t||(t=document.getElementById("xenioo-conversation-composer-buttonscontainer")),document.getElementById(options.chattextid?options.chattextid:"xenioo-user-chat-textarea-control").style.display="none",t.insertBefore(pwfield,t.childNodes[0]),pwfield.focus()}}function removePasswordField(){if(null!=pwfield){var e=document.getElementById("xenioo-conversation-textarea");e&&null!=e||(e=document.getElementById("xenioo-conversation-composer-buttonscontainer"));var t=document.getElementById(options.chattextid?options.chattextid:"xenioo-user-chat-textarea-control");t.style.display="",e.removeChild(pwfield),pwfield=null,t.focus()}}function displayButton(e,t,o){if(null==buttoncont&&("url"!=o.SubType||"url"==o.SubType&&!o.Data.AutoOpen)){var n=document.createElement("div");n.className="x-message-bubble x-parttype-1",n.innerHTML=getAvatarInline(t);var a=document.createElement("div");a.className="x-message-bubble-content",(buttoncont=document.createElement("div")).className="x-qbuttons-container",a.appendChild(buttoncont),n.appendChild(a),options.landingpage?chatarea.insertBefore(n,chatinputarea):chatarea.appendChild(n)}var i=o.Data&&o.Data.CssClass?replaceQuote(o.Data.CssClass):"",r="";o.Data&&o.Data.ImageUrl&&(r="<div class='x-button-icon' style=\"background-image:Url('"+o.Data.ImageUrl+"')\"></div>"),"link"==o.SubType?write("<div class='x-button-link "+replaceQuote(i)+"' id='x-button"+buttoncounter+"' onclick=\"xenioowebchat.Command('"+dropSinglePoint(e)+"','"+dropSinglePoint(o.Command)+"')\" >"+r+o.Text+"</div>",buttoncont,o):"url"==o.SubType?o.Data.AutoOpen?openForm(null,dropSinglePoint(o.Command),o.Data.RedirectToFloating,o.Data.InlineDisplay,o.Data.Caption,o.Data.Confirm,o.Data.Cancel,o.Data.HideConfirmButton,o.Data.HideCancelButton,o.Data.SwapButtonsOrder):write("<div class='x-button-link "+replaceQuote(i)+"' id='x-button"+buttoncounter+"' onclick=\"xenioowebchat.openForm( this, '"+dropSinglePoint(o.Command)+"', "+o.Data.RedirectToFloating+","+o.Data.InlineDisplay+", '"+o.Data.Caption+"', '"+o.Data.Confirm+"', '"+o.Data.Cancel+"', "+o.Data.HideConfirmButton+", "+o.Data.HideCancelButton+", "+o.Data.SwapButtonsOrder+' )" >'+r+o.Text+"</div>",buttoncont,o):write("<div class='x-button "+replaceQuote(i)+"' id='x-button"+buttoncounter+"' onclick=\"xenioowebchat.Command('"+dropSinglePoint(e)+"','"+dropSinglePoint(o.Command)+"')\" >"+r+o.Text+"</div>",buttoncont,o)}function openForm(e,t,o,n,a,i,r,s,l,c){if(formopened=!0,(read_interval/=2)<5e3&&(read_interval=5e3),null!=e?(e.onclick=null,e.className="x-button",e.style.cursor="default",e.innerHTML="<img id='x-form-wait-img' width='24' src='"+root+"/"+content+"/loader.gif'>"+e.innerHTML):(moveinChatWidget(),openChat()),s&&(i=""),l&&(r=""),!o&&!n||options.preview)window.open(t);else{var d={Text:a,Command:t,Parts:[],Data:{HideConfirmButton:s,HideCancelButton:l,InlineDisplay:n,SwapButtonsOrder:c}};c?(d.Parts.push({Text:r,Command:"document.getElementById('xenioo-floating-iframe').contentWindow.postMessage( 'xenioo_cancelForm', '*' )"}),d.Parts.push({Text:i,Command:"document.getElementById('xenioo-floating-iframe').contentWindow.postMessage( 'xenioo_confirmForm', '*' )"})):(d.Parts.push({Text:i,Command:"document.getElementById('xenioo-floating-iframe').contentWindow.postMessage( 'xenioo_confirmForm', '*' )"}),d.Parts.push({Text:r,Command:"document.getElementById('xenioo-floating-iframe').contentWindow.postMessage( 'xenioo_cancelForm', '*' )"})),showFloatingUrlWithButtons(d)}}function showFloatingUrlWithButtons(e){var t=document.getElementById("xenioo-floating-context-header");document.getElementById("xenioo-floating-extra-content-header-title").innerHTML=e.Text;var o=document.getElementById("xenioo-floating-extra-content-body");if(0==e.Text.length?(t.style.display="none",o.setAttribute("style","margin-top:0px !important")):(t.style.display="",o.setAttribute("style","")),options.displaymode==MODE_RIGHT_BAR)o.innerHTML="<iframe id='xenioo-floating-iframe' class='xenioo-float-extra-content-iframe-with-buttons-panel' src='"+e.Command+"'></iframe>";else{var n=480;0==e.Text.length&&(n+=64),e.Data.HideConfirmButton&&e.Data.HideCancelButton&&(n+=56),o.innerHTML="<iframe id='xenioo-floating-iframe' class='xenioo-float-extra-content-iframe-with-buttons' style='height:"+n+"px' src='"+e.Command+"'></iframe>"}for(var a="",i=e.Parts.length-1;i>=0;i--)e.Parts[i].Text&&e.Parts[i].Text.length>0&&(a+="<div class='xenioo-float-card-button' style='background:"+options.floatcolor+"' id='float-button-"+i+"' onclick=\""+e.Parts[i].Command+'">'+e.Parts[i].Text+"</div>");(a.length>0&&(o.innerHTML+="<div style='background:"+options.backcolor+"' class='xenioo-float-card-buttons-container'>"+a+"</div>"),e.Data.InlineDisplay&&options.displaymode!=MODE_RIGHT_BAR)&&(document.getElementById("xenioo-floating-extra-content").setAttribute("style","right:20px !important;z-index:2147483055;"),chatcontainer.setAttribute("style","opacity:0"));hideFloatCloseButton(),openFloatContent()}function disableFloatButtons(){for(var e=0,t=document.getElementById("float-button-"+e);null!=t;)t.className="xenioo-float-card-button-disabled",t.onclick=null,e++,t=document.getElementById("float-button-"+e)}function showFloatingUrl(e){document.getElementById("xenioo-floating-extra-content-header-title").innerHTML=e.Text;e.Data&&e.Data.CloseFloatingOnUrl&&e.Data.CloseFloatingOnUrl,document.getElementById("xenioo-floating-extra-content-body").innerHTML="<iframe id='xenioo-floating-iframe' class='xenioo-float-extra-content-iframe' src='"+e.Command+"'></iframe>",showFloatCloseButton(),openFloatContent()}function showCallout(e){widget&&options.showbubble&&!isChatOpened()&&(null==calloutbubble?((calloutbubble=document.createElement("div")).setAttribute("id","xenioo-calloutbubble"),calloutbubble.setAttribute("class","xenioo-conversation-calloutbubble"),calloutbubble.innerHTML=e,calloutbubble.style.opacity=0,widget.appendChild(calloutbubble),(calloutbubblehint=document.createElement("div")).setAttribute("class","xenioo-conversation-calloutbubble-hint"),calloutbubblehint.style.opacity=0,widget.appendChild(calloutbubblehint)):(calloutbubble.style.opacity=0,calloutbubblehint.style.opacity=0,calloutbubble.innerHTML=e),calloutbubble.style.opacity=1,calloutbubblehint.style.opacity=1)}function hideCallout(){null!=calloutbubble&&(widget.removeChild(calloutbubble),widget.removeChild(calloutbubblehint),calloutbubble=null,calloutbubblehint=null)}function showFloatCard(e){document.getElementById("xenioo-floating-extra-content-header-title").innerHTML=e.Text;var t=document.getElementById("xenioo-floating-extra-content-body"),o=!1;options.onFloatingAreaRender&&(o=options.onFloatingAreaRender(t,e)),o||(hasValue(e.Data.ImageUrl)?t.innerHTML="<img class='xenioo-float-card-image' src='"+e.Data.ImageUrl+"'><div class='xenioo-float-card-text'>"+e.Data.Subtitle+"</div>":hasValue(e.Data.Url)?t.innerHTML="<iframe id='xenioo-floating-iframe' class='xenioo-float-extra-content-iframe' src='"+e.Data.Url+"'></iframe>":hasValue(e.Data.Subtitle)&&(t.innerHTML="<div class='xenioo-float-card-text'>"+e.Data.Subtitle+"</div>"));for(var n="",a=e.Parts.length-1;a>=0;a--)switch(e.Parts[a].SubType){case"postback":n+="<div class='xenioo-float-card-button' onclick='xenioowebchat.callFloatAction(\""+e.Parts[a].Text+'", "'+e.Parts[a].Command+"\")'>"+e.Parts[a].Text+"</div>";break;case"web_url":n+="<div class='xenioo-float-card-button' onclick=\""+e.Parts[a].Command+'">'+e.Parts[a].Text+"</div>"}t.innerHTML+="<div class='xenioo-float-card-buttons-container'>"+n+"</div>",showFloatCloseButton(),openFloatContent()}function showFloatCloseButton(){document.getElementById("xenioo-floating-context-close-button").style.display=""}function hideFloatCloseButton(){document.getElementById("xenioo-floating-context-close-button").style.display="none"}function replaceQuote(e){var t=new RegExp("'","g");return e=e.replace(t,"'")}function hasValue(e){return!isNullOrEmpty(e)}function isNullOrEmpty(e){return!e||null==e||void 0===e||0==e.length}function callFloatAction(e,t){closeFloatContent(),say(e,t)}function writeWarning(e){write("<div class='x-message-bubble'>"+getAvatarInline(0)+"<div class='x-message-bubble-content'><div class='x-bubble-hint'></div><div class='"+getMessageBubbleClass()+"-warn'>"+linkify(e)+"</div></div></div>")}function renderList(e){for(var t="<div class='x-list-container fix-sizing' id='"+getChatItemId()+"'>",o=0;o<e.Parts.length;o++)t+=renderListItem(e.Parts[o],0==o&&"large"==e.SubType);return itemid++,t+="</div>"}function renderListItem(e,t){var o="";o=17==e.Type?!e.Data.OpenInSameWindow||options.preview?"<div class='x-list-item fix-sizing' style='cursor:pointer' onclick='window.open(\""+e.Command+"\")'>":"<div class='x-list-item fix-sizing' style='cursor:pointer' onclick='window.location.href = \""+e.Command+"\"'>":t?"<div class='x-list-item-large fix-sizing' style='background:url(\""+e.Data.ImageUrl+"\");background-repeat: no-repeat;background-size: cover;'>":"<div class='x-list-item fix-sizing'>",o+="<div class='x-list-text-container fix-sizing'><div class='x-list-title'>"+fix(e.Text)+"</div>",e.Data.Description?o+="<div class='x-list-subtitle fix-sizing' style='max-width: 150px;' title='"+fix(e.Data.Description)+"'>"+fix(e.Data.Description)+"</div>":o+="<div class='x-list-subtitle fix-sizing' title='"+fix(e.Data.Subtitle)+"'>"+fix(e.Data.Subtitle)+"</div>";for(var n=0;n<e.Parts.length;n++)o+=renderButton(e.Parts[n]);return o+="</div>",t||(isNullOrEmpty(e.Data.ImageUrl)?o+="<div class='x-list-image-container fix-sizing'></div>":isNullOrEmpty(e.Data.Url)?o+="<div class='x-list-image-container fix-sizing'><img class='x-list-image' src='"+e.Data.ImageUrl+"'></div>":isUrl(e.Data.Url)?o+="<div class='x-list-image-container fix-sizing'><a href='"+e.Data.Url+"'><img class='x-list-image' src='"+e.Data.ImageUrl+"'></a></div>":o+="<div class='x-list-image-container fix-sizing'><img onclick=\""+e.Data.Url+"\" style='cursor:pointer' class='x-list-image' src='"+e.Data.ImageUrl+"'></div>"),o+="</div>"}function isUrl(e){return 0==e.toLowerCase().indexOf("http")||0==e.toLowerCase().indexOf("www")}function renderCarousel(e){var t=options.landingpage&&!isMobileDevice?3:1,o=200+(options.landingpage&&!isMobileDevice?10:0),n="",a=o*(e.Parts.length<t?e.Parts.length:t);a>o&&(n="width:"+a+"px");for(var i="<div class='x-carousel-container-whole' style='"+n+"'><div class='x-card-carousel-container fix-sizing' data-index='0' data-max='"+e.Parts.length+"' id='carousel_"+itemid+"'>",r=0;r<e.Parts.length;r++)i+=renderCard(e.Parts[r],!0);return i+="</div>",e.Parts.length>1&&e.Parts.length>t&&(i+="<div id='carousel_"+itemid+"_left_arrow' onclick='xenioowebchat.ScrollCarousel(-4, "+itemid+", -1)' class='x-card-carousel-container-left-arrow xenioo-arrow-hidden'></div>"),e.Parts.length>1&&e.Parts.length>t&&(i+="<div id='carousel_"+itemid+"_right_arrow' onclick='xenioowebchat.ScrollCarousel(4, "+itemid+", 1)' class='x-card-carousel-container-right-arrow'></div>"),itemid++,i+="</div>"}function renderCard(e,t){var o="<div class='x-card "+(t?"carousel":"")+" fix-sizing'>";e.Data&&e.Data.ImageUrl&&(hasValue(e.Data.Url)?isUrl(e.Data.Url)?o+="<div class='x-card-image-container fix-sizing'><a href='"+e.Data.Url+"'><img class='x-card-image' src='"+e.Data.ImageUrl+"'></a></div>":o+="<div class='x-card-image-container fix-sizing'><img onclick=\""+e.Data.Url+"\" style='cursor:pointer' class='x-card-image' src='"+e.Data.ImageUrl+"'></div>":o+="<div class='x-card-image-container fix-sizing'><img class='x-card-image' src='"+e.Data.ImageUrl+"'></div>"),e.Data&&e.Data.Subtitle?(o+="<div style='display: flex; flex-direction: column;height: 100%;'>",e.Data.Url?o+="<div class='x-card-title fix-sizing' style='cursor:pointer;' onclick=\"window.open('"+e.Data.Url+"','_blank')\">"+fix(e.Text)+"</div>":o+="<div class='x-card-title fix-sizing'>"+fix(e.Text)+"</div>",o+="<div style='min-height:80px' class='x-card-subtitle fix-sizing'>"+fix(e.Data.Subtitle)+"</div>",o+="</div>"):o+="<div class='x-card-subtitle fix-sizing'>"+fix(e.Text)+"</div>",o+="<div class='x-card-buttons-container fix-sizing'>";for(var n=0;n<e.Parts.length;n++)o+=renderButton(e.Parts[n]);return o+="</div></div>"}function renderButton(e){if(null!=e&&e){var t="xenioowebchat.CloseChatMenuIfOpened();",o="";switch(1==options.contexttype&&(t="",o="style='color:"+options.backcolor+"' "),e.SubType){case"element_share":return"";case"phone_number":return"<a class='x-card-button fix-sizing' "+o+' href="tel:'+e.Command+'" onclick="'+t+'return true;" >'+e.Text+"</a>";case"web_url":return e.Data.RedirectToFloating?"<div class='x-card-button fix-sizing' "+o+" onclick=\"xenioowebchat.showFloatingUrl({Text:'"+e.Text+"',Command:'"+e.Command+"',Data:{CloseFloatingOnUrl:'"+e.Data.CloseFloatingOnUrl+"'}})\">"+e.Text+"</a>":options.preview||!e.Data.OpenInSameWindow?"<a class='x-card-button fix-sizing' "+o+' href="'+e.Command+'" target="_blank" onclick="'+t+'return true;" >'+e.Text+"</a>":"<a class='x-card-button fix-sizing' "+o+' href="'+e.Command+'" onclick="'+t+'return true;" >'+e.Text+"</a>";default:return"<div class='x-card-button fix-sizing' "+o+" onclick=\"xenioowebchat.Command('"+dropSinglePoint(fix(e.Text))+"','"+dropSinglePoint(e.Command)+"', this);"+t+'" >'+e.Text+"</div>"}}}function dropSinglePoint(e){return e&&null!=e?e=(e=e.replace(/"/g,"''")).replace(/'/g,"\\'"):""}function fix(e){if(isNullOrEmpty(e))return"";for(;e.indexOf("\n")>=0;)e=e.replace("\n","<br style='display: block;'/>");return e.indexOf("**")>=0&&(e=replaceTextByRegExMatch(e,/\*+(\S.*?\S)\*+|\*+(\S *?\S)\*+/gi,"**","<b>","</b>")),e.indexOf("__")>=0&&(e=replaceTextByRegExMatch(e,/\_+(\S.*?\S)\_+|\_+(\S *?\S)\_+/gi,"__","<b>","</b>")),e.indexOf("~~")>=0&&(e=replaceTextByRegExMatch(e,/\~+(\S.*?\S)\~+|\~+(\S *?\S)\~+/gi,"~~","<s>","</s>")),e.indexOf("*")>=0&&(e=replaceTextByRegExMatch(e,/\*(\S.*?\S)\*|\*(\S *?\S)\*/gi,"*","<b>","</b>")),e.indexOf("_")>=0&&(e=replaceTextByRegExMatch(e,/\_(\S.*?\S)\_|\_(\S *?\S)\_/gi,"_","<em>","</em>")),e.indexOf("~")>=0&&(e=replaceTextByRegExMatch(e,/\~(\S.*?\S)\~|\~(\S *?\S)\~/gi,"~","<s>","</s>")),e}function replaceTextByRegExMatch(e,t,o,n,a){var i=e.match(t);if(!i||!Array.isArray(i)||0==i.length)return e;for(var r=0;r<i.length;r++){var s=i[r].substr(o.length,i[r].length-2*o.length);e=e.replace(i[r],n+s+a)}return e}function write(e,t,o){var n;t?((n=document.createElement("div")).innerHTML=e,options.onElementRender&&o&&options.onElementRender(n.firstChild,o),t.appendChild(n.firstChild)):((n=document.createElement("div")).innerHTML=e,options.onElementRender&&o&&options.onElementRender(n.firstChild,o),chatarea&&(options.landingpage?chatarea.insertBefore(n.firstChild,chatinputarea):chatarea.appendChild(n.firstChild)))}function getWelcome(){if(userclicked||!options.waitforwidgetclick){resetState();var e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState==XMLHttpRequest.DONE){var t=JSON.parse(e.response);setUserIdInfo(t),doReply(t),options.loadCompleted&&options.loadCompleted(),options.waitforwidgetclick||endWait(),reschedulePendingRead(),options.waitforwidgetclick?options.waitforwidgetclick=!1:0!=options.autoopenchatdelay?setTimeout(function(){autoOpenChat(!0)},1e3*options.autoopenchatdelay):autoOpenChat(!1)}},options.variables.push({Name:"web_channel_url",Value:window.location.origin+window.location.pathname}),options.variables.push({Name:"web_channel_referral",Value:getReferral()}),e.open("GET",api+"/webapi/endpoint/chat",!0),setWelcomeHeaders(e),setVariables(e),setTags(e),options.rewindchat&&(e.setRequestHeader("rw","1"),logging=!0),options.onDataConnection&&options.onDataConnection(),e.send()}else setCounter(null)}function getReferral(){return document.referrer&&""!=document.referrer?document.referrer:""}function setVariables(e){for(var t="",o=0;o<options.variables.length;o++)t+=options.variables[o].Name+"|"+window.btoa(options.variables[o].Value)+"|";var n=(window.location.search.split("?")[1]||"").split("&");for(var a in n)n.hasOwnProperty(a)&&(paramParts=n[a].split("="),t+=paramParts[0]+"|"+window.btoa(decodeURIComponent(paramParts[1]||""))+"|");0!=t.length&&e.setRequestHeader("bot-vars",t.substring(0,t.length-1))}function setParamVariables(e,t){if(void 0!==t&&null!=t){for(var o="",n=Object.keys(t),a=0;a<n.length;a++){var i=null;try{i=window.btoa(t[n[a]])}catch(e){console.log("%cXenioo:[Warning] - Param "+n[a]+" failed to parse to btoa. Ignored.","color:darkorange")}o+=n[a]+"|"+i+"|"}e.setRequestHeader("bot-vars",o.substring(0,o.length-1))}}function setTags(e){for(var t="",o=0;o<options.tags.length;o++)t+=options.tags[o]+"|";0!=t.length&&e.setRequestHeader("bot-tags",t)}function autoOpenChat(e){if(e){if(options.autoopenchatmobiledisabled&&isMobileDevice)return;button&&(button.style.opacity=1),openChat()}else options.autoopencontext&&e&&(1==options.contexttype?(button.style.opacity=1,toggleChat()):toggleChatMenu())}function readPending(){if(reading_chat)reschedulePendingRead();else if(!reading_scheduled){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(reading_scheduled=!1,e.readyState==XMLHttpRequest.DONE){var t=JSON.parse(e.response);t.I&&t.I>0&&t.I>maxposindex&&(maxposindex=t.I),t.Parts.length>0?(read_interval=max_read_interval/2,formopened=!1,endWait(),doReply(t)):(formopened||(read_interval+=1e3)>max_read_interval&&(read_interval=max_read_interval),postReplyMsg(t)),1==t.ControlType&&(sendbutton&&(sendbutton.disabled=!1),chattext&&(chattext.disabled=!1)),reschedulePendingRead()}},e.open("GET",api+"/webapi/endpoint/chat",!0),setHeaders(e),e.setRequestHeader("pen","1"),options.viewmode>0&&(e.setRequestHeader("sto","1"),e.setRequestHeader("mai",maxposindex)),options.onDataConnection&&options.onDataConnection(),e.send(),reading_scheduled=!0}}function postReplyMsg(e){e&&window.parent&&window.parent.postMessage({x_ms:e.M,x_as:e.A,x_ss:e.S},"*")}function reschedulePendingRead(){setTimeout(function(){readPending()},read_interval)}function send(e,t,o){if(null!=e||null!=t){reading_chat=!0,removeOrDisableButtons(),resetState(),options.landingpage&&chatinputarea&&(chatinputarea.style.opacity=0);var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(reading_chat=!1,endWait(),n.response&&""!=n.response&&doReply(JSON.parse(n.response)))};var a={Text:e,Command:t};2==options.viewmode&&("HAND_OVER"!=t&&(a.Command="VIEW_2"),a.ChannelProviderId=options.prid,a.ChannelId=options.chid,a.UserId=options.userid);var i="";"attachment"==t&&(a.Command=o.file,a.CommandType="attachment;"+o.fileName,i=o.fileName,o.file=null,o.fileName=null,o.fileSize=null,o.fileType=null),null==t?options.onUserSays&&options.onUserSays(e):options.onButtonClick&&options.onButtonClick(e,t),n.open("POST",api+"/webapi/endpoint/chat",!0),setHeaders(n),setParamVariables(n,o),n.setRequestHeader("Content-type","application/json"),options.onDataConnection&&options.onDataConnection(),0==options.viewmode&&(n.onprogress=function(){3==n.readyState&&0!=i.length&&(writeUser("<svg width='18' height='17' viewBox='0 0 18 17' xmlns='http://www.w3.org/2000/svg'><path fill='"+options.forecolor+"' d='M8.455 16.5c-.19 0-.378-.076-.522-.226-.29-.303-.29-.792 0-1.093l7.66-8.013c.57-.597.885-1.392.885-2.236 0-.844-.315-1.638-.886-2.235-1.18-1.233-3.097-1.232-4.275 0L2.433 11.99c-.5.525-.742 1.03-.715 1.502.026.46.303.815.467.985.275.29.573.41.908.364.42-.054.903-.356 1.398-.874l6.973-7.295c.288-.3.755-.3 1.043 0 .29.303.29.793 0 1.093l-6.97 7.296c-.74.773-1.5 1.215-2.26 1.314-.797.104-1.535-.175-2.135-.804-.537-.562-.856-1.267-.896-1.985-.054-.933.332-1.836 1.144-2.686l8.885-9.297c1.754-1.836 4.61-1.836 6.363 0 .85.888 1.318 2.07 1.318 3.328s-.468 2.44-1.318 3.33l-7.66 8.014c-.143.15-.332.226-.52.226z' fill-rule='evenodd'></path></svg>&nbsp;"+i),i="")}),n.send(JSON.stringify(a))}}function sendAttachment(e){var t=event.target.files[0].name,o=event.target.files[0].size,n=event.target.files[0].type;if(!(o/1024/1024>10)){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){send(null,"attachment",{file:a.result,fileName:t,fileSize:o,fileType:n})},a.onerror=function(e){}}}function resetState(){chattext&&(chattext.value=""),firstbutton=!0,buttoncounter=0}function removeOrDisableButtons(){for(var e=0;e<buttoncounter;e++){var t=document.getElementById("x-button"+e);if(null!=t){var o=t.closest(".x-message-bubble");null!=o&&o.parentElement.removeChild(o)}}}function setWelcomeHeaders(e){setHeaders(e),options.behaviour&&e.setRequestHeader("in-be",options.behaviour)}function setHeaders(e){e&&(shared&&e.setRequestHeader("sh",shared?"T":"F"),options&&(e.setRequestHeader("bot-channel-id",options.id),e.setRequestHeader("user-id",options.userid),e.setRequestHeader("fc",options.firstContact),e.setRequestHeader("lc",options.lastContact)))}function setVariableHeaders(e){if(options){if(options.variables)for(var t=0;t<options.variables.length;t++)e.setRequestHeader("variable-"+options.variables[t].name,options.variables[t].value);if(options.tags)for(t=0;t<options.tags.length;t++)e.setRequestHeader("tag-"+options.tags[t],options.tags[t])}}function setLastContact(){var e=new Date;options.lastContact=e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear(),writeCookie("lc",options.lastContact,1024)}function setFirstContact(){if(options.firstContact=readCookie("fc"),null==options.firstContact){var e=new Date;options.firstContact=e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear(),writeCookie("fc",options.firstContact,1024)}}function loadCSS(e,t){var o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",e),null!=t&&(o.onload=function(){t()},o.onerror=function(){t()}),document.getElementsByTagName("head")[0].appendChild(o)}function loadJS(e){var t=document.createElement("script");t.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(t)}function setChatState(e){chattext.disabled=!e}function writeCookie(e,t,o){var n="";if(o){var a=new Date;a.setTime(a.getTime()+24*o*60*60*1e3),n="; expires="+a.toUTCString()}document.cookie=e+"="+t+n+"; path=/"}function readCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var a=o[n];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null}function eraseCookie(e){writeCookie(e,"",-1)}function getChatItemId(){return lastitemid="chat_item_"+ ++itemid}function scrollCarousel(e,t,o){var n=document.getElementById("carousel_"+t),a=parseInt(n.getAttribute("data-index")),i=parseInt(n.getAttribute("data-max"));a+=o;var r=document.getElementById("carousel_"+t+"_left_arrow"),s=document.getElementById("carousel_"+t+"_right_arrow");a<=0?r.classList.add("xenioo-arrow-hidden"):r.classList.remove("xenioo-arrow-hidden"),a>=i-1?s.classList.add("xenioo-arrow-hidden"):s.classList.remove("xenioo-arrow-hidden"),n.setAttribute("data-index",a);var l=n.firstElementChild.getBoundingClientRect().width;scrollTo(n,l,e,5)}function scrollTo(e,t,o,n){setTimeout(function(){e.scrollLeft=e.scrollLeft+o,(t-=Math.abs(o))<=0||scrollTo(e,t,o,n*=1.01)},n)}function scollDownChat(e,t){options.landingpage?scrollDownChatSmooth(e,t):scrollDownChatDefault(e,t)}function scrollDownChatDefault(e,t,o){e&&(e.clientHeight>=e.scrollHeight||(o||(o=25,e.scrollHeight-e.clientHeight>1e3&&(o=250)),setTimeout(function(){e.scrollTop=e.scrollTop+o,--o<3?o=3:e.scrollTop!=e.scrollHeight-e.clientHeight&&scrollDownChatDefault(e,t,o)},10)))}function scrollDownChatSmooth(e,t){if(e&&!(e.scrollTop>=e.scrollHeight||scrollDownChatIsAnimating)){var o=e.scrollTop,n=e.scrollHeight-o,a=0,i=function(){a+=20;var r=Math.easeInOutQuad(a,o,n,t);e.scrollTop=r,a<t?setTimeout(i,20):scrollDownChatIsAnimating=!1};scrollDownChatIsAnimating=!0,i()}}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function getVariable(e){if(null==e||!e||0==e.length)return null;if(null==this.variables||!this.variables||0==this.variables.length)return null;var t=this.variables.filter(t=>t.Name.toLowerCase()==e.toLowerCase());return 0==t.length?null:t[0].Value}function enableCrossMessages(){addEvent(window,"message",function(e){switch(event.data){case"xenioo_toggleFloatContent":chatcontainer.setAttribute("style",""),toggleFloatContent();break;case"xenioo_disableFloatButtons":disableFloatButtons()}})}function addEvent(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent&&e.attachEvent("on"+t,o)}function detectswipe(e,t,o){swipe_det=new Object,swipe_det.sX=0,swipe_det.sY=0,swipe_det.eX=0,swipe_det.eY=0;var n="";ele=document.getElementById(e),ele.addEventListener("touchstart",function(e){var t=e.touches[0];swipe_det.sX=t.screenX,swipe_det.sY=t.screenY},!1),ele.addEventListener("touchmove",function(e){e.preventDefault();var t=e.touches[0];swipe_det.eX=t.screenX,swipe_det.eY=t.screenY},!1),ele.addEventListener("touchend",function(a){(swipe_det.eX-30>swipe_det.sX||swipe_det.eX+30<swipe_det.sX)&&swipe_det.eY<swipe_det.sY+60&&swipe_det.sY>swipe_det.eY-60&&swipe_det.eX>0?n=swipe_det.eX>swipe_det.sX?"r":"l":(swipe_det.eY-50>swipe_det.sY||swipe_det.eY+50<swipe_det.sY)&&swipe_det.eX<swipe_det.sX+30&&swipe_det.sX>swipe_det.eX-30&&swipe_det.eY>0&&(n=swipe_det.eY>swipe_det.sY?"d":"u"),""!=n&&"function"==typeof o&&o(e,t,n),n="",swipe_det.sX=0,swipe_det.sY=0,swipe_det.eX=0,swipe_det.eY=0},!1)}return linkify=(URI_RE=new RegExp("(?:\\b[a-z\\d.-]+://[^<>\\s]+|\\b(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)|(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5]))(?:[;/][^#?<>\\s]*)?(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w)|(?:mailto:)?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)|(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5]))(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w))","ig"),SCHEME_RE=new RegExp("^[a-z\\d.-]+://","i"),quotes={"'":"`",">":"<",")":"(","]":"[","}":"{","»":"«","›":"‹"},default_options={callback:function(e,t){return t?'<a href="'+t+'" title="'+t+"\" target='_blank' >"+e+"</a>":e},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/},function(e,t){t=t||{};var o,n,a,i,r,s,l,c,d,u,p,m,g="",h=[];for(n in default_options)void 0===t[n]&&(t[n]=default_options[n]);for(;o=URI_RE.exec(e);)if(a=o[0],l=(s=URI_RE.lastIndex)-a.length,!/[\/:]/.test(e.charAt(l-1))){do{c=a,m=a.substr(-1),(p=quotes[m])&&(d=a.match(new RegExp("\\"+p+"(?!$)","g")),u=a.match(new RegExp("\\"+m,"g")),(d?d.length:0)<(u?u.length:0)&&(a=a.substr(0,a.length-1),s--)),t.punct_regexp&&(a=a.replace(t.punct_regexp,function(e){return s-=e.length,""}))}while(a.length&&a!==c);i=a,SCHEME_RE.test(i)||(i=(-1!==i.indexOf("@")?i.indexOf("mailto:")?"mailto:":"":i.indexOf("irc.")?i.indexOf("ftp.")?"http://":"ftp://":"irc://")+i),r!=l&&(h.push([e.slice(r,l)]),r=s),h.push([a,i])}for(h.push([e.substr(r)]),n=0;n<h.length;n++)g+=t.callback.apply(window,h[n]);return g||e}),Math.easeInOutQuad=function(e,t,o,n){return(e/=n/2)<1?o/2*e*e+t:-o/2*(--e*(e-2)-1)+t},{Start:xenioo,Restart:xeniooRestart,StartAsLanding:xeniooLanding,TryAutoStart:xeniooAutoStart,EmbedChatLanding:embedChatLanding,EmbedChatFullPage:embedChatFullPage,Command:doCommand,openForm:openForm,OpenForm:openForm,say:say,Say:say,Send:send,send:send,scrollCarousel:scrollCarousel,ScrollCarousel:scrollCarousel,closeChatMenuIfOpened:closeChatMenuIfOpened,CloseChatMenuIfOpened:closeChatMenuIfOpened,toggleChat:toggleChat,ToggleChat:toggleChat,openChat:openChat,closeChat:closeChat,isChatOpened:isChatOpened,callFloatAction:callFloatAction,closeFloatContent:closeFloatContent,openFloatContent:openFloatContent,toggleFloatContent:toggleFloatContent,showFloatingUrl:showFloatingUrl,attachFile:attachFile,goTo:goTo,disableFloatButtons:disableFloatButtons,getVariable:getVariable,handOver:handOver,Utils:{dropSinglePoint:dropSinglePoint,DropSinglePoint:dropSinglePoint,fixText:fix,FixText:fix,IsNullOrEmpty:isNullOrEmpty,isNullOrEmpty:isNullOrEmpty}}}();function Xenioo(e,t){return xenioowebchat.Start(e,t),xenioowebchat}xenioowebchat.TryAutoStart();